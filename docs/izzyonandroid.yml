repository: https://github.com/dongdongbh/Mindwtr.git
updates: releases
labels:
  - expo
  - react-native
versions:
  - tag: v0.4.7
    apks:
      - apk_pattern: mindwtr-.*-arm64-v8a-foss\\.apk
        apk_url: https://github.com/dongdongbh/Mindwtr/releases/download/v0.4.7/mindwtr-0.4.7-arm64-v8a-foss.apk
        build:
          - wget -q -O /tmp/nodejs-lts.tar.xz -- https://nodejs.org/dist/v22.20.0/node-v22.20.0-linux-x64.tar.xz
          - sha256sum -c <<< '00bbd05e306ea68b6e13e17360d0e2f680b493ef95f2fea1c4296ff7437530bc  /tmp/nodejs-lts.tar.xz'
          - tar xf /tmp/nodejs-lts.tar.xz -C /opt
          - export PATH="${PATH}:/opt/node-v22.20.0-linux-x64/bin"
          - curl -fsSL https://bun.sh/install | bash
          - export PATH="$HOME/.bun/bin:$PATH"
          - test -d apps/mobile/android && rm -rf apps/mobile/android
          - cd apps/mobile
          - bash ./scripts/fdroid_prep.sh
          - bun install
          - FOSS_BUILD=1 ARCHS=arm64-v8a OUTPUT_DIR=./build bash ./scripts/android_build.sh
          - find ./build -name '*.apk' -maxdepth 2
        build_cpus:
        build_home_dir: /build
        build_repo_dir: /build/repo
        build_timeout: 40
        build_user: build
        provisioning:
          android_home: /opt/sdk
          cmdline_tools:
            version: '19.0'
            url: https://dl.google.com/android/repository/commandlinetools-linux-13114758_latest.zip
            sha256: 7ec965280a073311c339e571cd5de778b9975026cfcbe79f2b1cdcb1e15317ee
          extra_packages:
            - xz-utils
          image: ubuntu:jammy
          jdk: openjdk-17-jdk-headless
          verify_gradle_wrapper: true
